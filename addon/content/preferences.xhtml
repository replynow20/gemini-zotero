<linkset>
  <html:link rel="localization" href="geminizotero-addon.ftl" />
  <html:link rel="localization" href="geminizotero-preferences.ftl" />
</linkset>
<preferences id="zotero-prefpane-geminizotero-preferences">
  <preference id="extensions.zotero.geminizotero.apiKey" name="extensions.zotero.geminizotero.apiKey" type="string" />
  <preference id="extensions.zotero.geminizotero.apiBaseUrl" name="extensions.zotero.geminizotero.apiBaseUrl"
    type="string" />
  <preference id="extensions.zotero.geminizotero.model" name="extensions.zotero.geminizotero.model" type="string" />
  <preference id="extensions.zotero.geminizotero.autoSaveStructuredOutput"
    name="extensions.zotero.geminizotero.autoSaveStructuredOutput" type="bool" default="true" />
  <preference id="extensions.zotero.geminizotero.temperature" name="extensions.zotero.geminizotero.temperature"
    type="string" />
  <preference id="extensions.zotero.geminizotero.topP" name="extensions.zotero.geminizotero.topP" type="string" />
  <preference id="extensions.zotero.geminizotero.topK" name="extensions.zotero.geminizotero.topK" type="string" />
  <preference id="extensions.zotero.geminizotero.maxOutputTokens" name="extensions.zotero.geminizotero.maxOutputTokens"
    type="string" />
  <preference id="enableTagSync" name="extensions.zotero.geminizotero.enableTagSync" type="bool" default="true" />
  <preference id="tagLanguage" name="extensions.zotero.geminizotero.tagLanguage" type="string" />

</preferences>
<groupbox onload="Zotero.__addonInstance__.hooks.onPrefsEvent('load', { window })">
  <label>
    <html:h2 data-l10n-id="prefs-title"></html:h2>
  </label>

  <!-- API Key -->
  <hbox align="center">
    <html:label for="zotero-prefpane-geminizotero-apikey" style="width: 140px" data-l10n-id="prefs-api-key">
    </html:label>
    <html:input type="password" id="zotero-prefpane-geminizotero-apikey" preference="apiKey" style="flex: 1"
      data-l10n-id="prefs-api-key-placeholder" data-l10n-attrs="placeholder">
    </html:input>
  </hbox>

  <!-- API Base URL -->
  <hbox align="center" style="margin-top: 10px">
    <html:label for="zotero-prefpane-geminizotero-apiurl" style="width: 140px" data-l10n-id="prefs-api-url">
    </html:label>
    <html:input type="text" id="zotero-prefpane-geminizotero-apiurl" preference="apiBaseUrl"
      data-l10n-id="prefs-api-url-placeholder" data-l10n-attrs="placeholder" style="width: 220px">
    </html:input>
    <html:span style="margin-left: 10px;">自定义API或 <html:a href="javascript:void(0)"
        onclick="Zotero.launchURL('https://api.replynow.cn:6688')"
        style="color: #1a73e8; text-decoration: none; cursor: pointer">购买</html:a>
    </html:span>
  </hbox>

  <!-- Model Selection -->
  <hbox align="center" style="margin-top: 10px">
    <html:label for="zotero-prefpane-geminizotero-model" style="width: 140px" data-l10n-id="prefs-model">
    </html:label>
    <menulist id="zotero-prefpane-geminizotero-model" preference="model">
      <menupopup>
        <menuitem label="Gemini 3 Flash Preview" value="gemini-3-flash-preview" />
        <menuitem label="Gemini 3 Pro Preview" value="gemini-3-pro-preview" />
      </menupopup>
    </menulist>
  </hbox>

  <!-- Separator for Model Parameters -->
  <label style="margin-top: 16px">
    <html:h3 style="margin-bottom: 4px; font-size: 14px; color: #555" data-l10n-id="prefs-model-params"></html:h3>
  </label>
  <html:p style="margin: 0 0 8px 0; font-size: 12px; color: #888" data-l10n-id="prefs-model-params-desc">
  </html:p>

  <!-- Temperature -->
  <hbox align="center" style="margin-top: 6px">
    <html:label for="zotero-prefpane-geminizotero-temperature" style="width: 140px" data-l10n-id="prefs-temperature">
    </html:label>
    <html:input type="number" min="0" max="2" step="0.1" id="zotero-prefpane-geminizotero-temperature"
      preference="temperature" placeholder="1.0" style="width: 50px; text-align: center"></html:input>
    <html:span style="margin-left: 8px; font-size: 11px; color: #888" data-l10n-id="prefs-temperature-desc">
    </html:span>
  </hbox>
  <html:p style="margin: 4px 0 0 140px; font-size: 11px; color: #888" data-l10n-id="prefs-temperature-detail">
  </html:p>

  <!-- Top P -->
  <hbox align="center" style="margin-top: 10px">
    <html:label for="zotero-prefpane-geminizotero-topp" style="width: 140px" data-l10n-id="prefs-top-p">
    </html:label>
    <html:input type="number" min="0" max="1" step="0.05" id="zotero-prefpane-geminizotero-topp" preference="topP"
      placeholder="0.95" style="width: 50px; text-align: center"></html:input>
    <html:span style="margin-left: 8px; font-size: 11px; color: #888" data-l10n-id="prefs-top-p-desc">
    </html:span>
  </hbox>
  <html:p style="margin: 4px 0 0 140px; font-size: 11px; color: #888" data-l10n-id="prefs-top-p-detail">
  </html:p>

  <!-- Top K -->
  <hbox align="center" style="margin-top: 10px">
    <html:label for="zotero-prefpane-geminizotero-topk" style="width: 140px" data-l10n-id="prefs-top-k">
    </html:label>
    <html:input type="number" min="1" id="zotero-prefpane-geminizotero-topk" preference="topK" placeholder="40"
      style="width: 50px; text-align: center"></html:input>
    <html:span style="margin-left: 8px; font-size: 11px; color: #888" data-l10n-id="prefs-top-k-desc">
    </html:span>
  </hbox>
  <html:p style="margin: 4px 0 0 140px; font-size: 11px; color: #888" data-l10n-id="prefs-top-k-detail">
  </html:p>

  <!-- Max Output Tokens -->
  <hbox align="center" style="margin-top: 10px">
    <html:label for="zotero-prefpane-geminizotero-maxtokens" style="width: 140px" data-l10n-id="prefs-max-tokens">
    </html:label>
    <html:input type="number" min="1" id="zotero-prefpane-geminizotero-maxtokens" preference="maxOutputTokens"
      placeholder="8192" style="width: 50px; text-align: center"></html:input>
    <html:span style="margin-left: 8px; font-size: 11px; color: #888" data-l10n-id="prefs-max-tokens-desc">
    </html:span>
  </hbox>
  <html:p style="margin: 4px 0 0 140px; font-size: 11px; color: #888" data-l10n-id="prefs-max-tokens-detail">
  </html:p>

  <!-- Restore Defaults Button for Model Parameters -->
  <hbox style="margin-top: 12px">
    <html:button id="zotero-prefpane-geminizotero-restore-defaults" style="padding: 6px 16px; cursor: pointer"
      onclick="Zotero.__addonInstance__.hooks.onPrefsEvent('restore-defaults', { window })"
      data-l10n-id="prefs-restore-defaults">
    </html:button>
  </hbox>

  <!-- Auto-save Option -->
  <checkbox id="zotero-prefpane-geminizotero-autosave" preference="autoSaveStructuredOutput"
    data-l10n-id="prefs-auto-save" style="margin-top: 14px" />

  <!-- Tags Sync Control -->
  <label style="margin-top: 16px">
    <html:h3 style="margin-bottom: 4px; font-size: 14px; color: #555" data-l10n-id="prefs-tags-section"></html:h3>
  </label>

  <hbox align="center" style="margin-top: 8px">
    <checkbox id="zotero-prefpane-geminizotero-enable-tag-sync" preference="enableTagSync"
      data-l10n-id="prefs-enable-tag-sync" data-l10n-attrs="label" />
    <html:label for="zotero-prefpane-geminizotero-tag-language" style="margin-left: 20px"
      data-l10n-id="prefs-tag-language">
    </html:label>
    <menulist id="zotero-prefpane-geminizotero-tag-language" preference="tagLanguage" style="margin-left: 8px">
      <menupopup>
        <menuitem label="简体中文" value="zh-CN" />
        <menuitem label="English" value="en-US" />
      </menupopup>
    </menulist>
  </hbox>


  <!-- About Section -->
  <label style="margin-top: 20px; padding-top: 16px; border-top: 1px solid #ddd">
    <html:h3 style="margin-bottom: 8px; font-size: 14px; color: #555" data-l10n-id="prefs-about"></html:h3>
  </label>
  <html:div style="font-size: 12px; color: #666; line-height: 1.6">
    <html:p style="margin: 0 0 6px 0">
      <html:strong>Gemini Zotero</html:strong> v__buildVersion__ · Developed by Devin Fan
    </html:p>
    <html:p style="margin: 0">
      <html:span data-l10n-id="prefs-about-url"></html:span>
      <html:a href="javascript:void(0)" onclick="Zotero.launchURL('https://ahuia.top:4430/s/7YBb8TKoaKmwJmJ')"
        style="color: #1a73e8; text-decoration: none; cursor: pointer">下载插件</html:a>
    </html:p>
  </html:div>
</groupbox>